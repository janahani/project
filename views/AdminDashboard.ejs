<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin DashBoard</title>

    <link rel="stylesheet" href="/css/styleActivities.css">
    <link rel="stylesheet" href="/css/styleAdminDashboard.css">
    <link rel="stylesheet" href="/css/styleHF_ALL.css">
    <link rel="stylesheet" href="/css/styleChat.css">

</head>
<style>
    .head{
        margin-bottom: 10px;
    }
</style>

<body>
    <script src="https://kit.fontawesome.com/ee4053c9b9.js" crossorigin="anonymous"></script>
    <script src="/js/chat.js"></script>

    <%- include("partials/adminHeader.ejs") %>

        <div class="main-content">
            <div class="right">
                <h2 class="head">TOP ACTIVITIES</h2>
                <div class="first">
                    <% if(Activities!=="") {%>
                        <% let id1=0; %>
                        <%topactivities.forEach((topactivity) => { %>
                            <%let rate1=activityratings[id1]; %>
                            <% Activities.forEach((Activity) => { %>
                            <% if( (Activity.Name.split(',').toString()) === (topactivity.split(',').toString()) ) { %>
                    <div class="btn">
                        <div>
                            <img src="/images/activities/<%=Activity.Picture[0]%>" width="260 px" height="200 px" >
                        </div>

                        <div>
                            <h5><%=Activity.Header%></h5>
                            <h4><%=Activity.Advantage%> </h4>
                        </div>
                        <span class="rating">
                            <% for(var k =0; k < rate1;k++){ %>
                                <i class="fa-solid fa-star"></i>
                                <% } %>
                            </span>

                    </div>
                    <% } %>
                    <% id1++; %>
                    <% }); %>
                    <% }); %>
                <% }%>
                    
                </div>
                


                <h2 class="head">TOP HOTELS</h2>
                <div class="first">
                    <% if(Hotels!=="") {%>
                        <% let id2=0; %>
                        <%tophotels.forEach((tophotel) => { %>
                            <%let rate2=hotelratings[id2]; %>
                        <% Hotels.forEach((hotel) => { %>
                            <% if( (hotel.Name.split(',').toString()) === (tophotel.split(',').toString()) ) { %>
                    <div class="btn">
                        <div>
                            <img src="/images/Hotels/<%=hotel.Picture[0]%>" width="260 px" height="200 px" >
                        </div>

                        <div>
                            <h3><%=hotel.Name%></h3>
                            <h4><%=hotel.Location%> </h4>
                        </div>

                        <span class="rating">
                        <% for(var k =0; k < rate2;k++){ %>
                            <i class="fa-solid fa-star"></i>
                            <% } %>
                        </span>
                         
                        </div>
                        <% } %>
                        <% id2++; %>
                        <% }); %>
                        <% }); %>
                    <% } %> 
                    </div>

            
        
            <h2 class="head">Weekly Hotel Reviews:</h2>
                <div class="first">
                    <% if(Hotels!=="") {%>
                    <% const nowdate = new Date().toLocaleString('en-GB', {hour12: false,});%>
                    <% const currday =nowdate.split("/")[0];%>
                    <% const currmonth =nowdate.split("/")[1];%>
                    <% const curryear =nowdate.split("/")[2].split(',')[0];%>
                    <% var currdate = new Date(curryear,currmonth-1,currday ); %>
                    <% let id3=0; %>
                     <% Hotels.forEach((hotel) => { %>
                    <% revs=hotel.Reviews%>
                    <% revs.forEach((rev)=>{%>
                    <% const day =rev.Date.split("/")[0];%>
                    <% const month =rev.Date.split("/")[1];%>
                    <% const year = rev.Date.split("/")[2].split(',')[0];%>
                    <% var revdate = new Date(year,month-1,day ); %>
                    <%var diffTime=Math.abs(currdate-revdate);%>
                    <% var diffDays=Math.ceil(diffTime/(1000*60*60*24));%>
                    <% if( diffDays<=7 ) { %>
                        <div class="btn">
                            <div class="rev">
                                <%=hotel.Name%>
                            </div>
                            <div class="rev" style="margin-bottom:6px;">
                                <%var daterev= rev.Date.split(',')[0];%>
                              <h6 class="R"> at <%=daterev%> </h6>
                            </div>
                            <span class="rating">
                              <% let rates=rev.Rating;%>
                                <% for(var i=0; i<rates; i++){%>
                                  <i class="fa-solid fa-star"></i>
                                  <%}%>
                                </span>
                            <div>
                              <p>
                                <%=rev.Comment%>
                              </p>
                            </div>
                          </div>
                    <% } %>
                    <% }); %>
                    <% id3++; %>
                    <% }); %>
                    <% } %>

                        </div>    

                <h2 class="head">Weekly Activity Reviews:</h2>
                <div class="first">
                    <% if(Activities!=="") {%>
                    <% const nowdate = new Date().toLocaleString('en-GB', {hour12: false,});%>
                    <% const currday =nowdate.split("/")[0];%>
                    <% const currmonth =nowdate.split("/")[1];%>
                    <% const curryear =nowdate.split("/")[2].split(',')[0];%>
                    <% var currdate = new Date(curryear,currmonth-1,currday ); %>
                    <% let id4=0; %>
                     <% Activities.forEach((activity) => { %>
                    <% revs=activity.Reviews%>
                    <% revs.forEach((rev)=>{%>
                    <% const day =rev.Date.split("/")[0];%>
                    <% const month =rev.Date.split("/")[1];%>
                    <% const year = rev.Date.split("/")[2].split(',')[0];%>
                    <% var revdate = new Date(year,month-1,day ); %>
                    <%var diffTime=Math.abs(currdate-revdate);%>
                    <% var diffDays=Math.ceil(diffTime/(1000*60*60*24));%>
                    <% if( diffDays<=7 ) { %>
                        <div class="btn">
                            <div class="rev">
                                <%=activity.Header%>
                            </div>
                            <div class="rev" style="margin-bottom:6px;">
                                <%var daterev= rev.Date.split(',')[0];%>
                              <h6 class="R"> <%=rev.Username%> wrote a review at <%=daterev%> </h6>
                            </div>
                            <span class="rating">
                              <% let rates=rev.Rating;%>
                                <% for(var i=0; i<rates; i++){%>
                                  <i class="fa-solid fa-star"></i>
                                  <%}%>
                                </span>
                            <div>
                              <p>
                                <%=rev.Comment%>
                              </p>
                            </div>
                          </div>
                    <% } %>
                    <% }); %>
                    <% id4++; %>
                    <% }); %>
                    <% } %>

                        </div> 
                    </div>
                </div>





</body>

</html>